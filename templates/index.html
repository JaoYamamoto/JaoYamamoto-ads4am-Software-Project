{% extends "base.html" %}

{% block title %}Minha Biblioteca - Início{% endblock %}

{% block content %}
<!-- Tela de boas-vindas para usuários não autenticados -->
<div id="welcomeScreen" class="welcome-screen" style="display: none;">
    <div class="welcome-content">
        <div class="welcome-header">
            <i class="fas fa-book-open welcome-icon"></i>
            <h1>Bem-vindo à Minha Biblioteca</h1>
            <p class="welcome-subtitle">Organize e gerencie sua coleção de livros pessoal</p>
        </div>
        
        <div class="welcome-features">
            <div class="feature-card">
                <i class="fas fa-plus-circle"></i>
                <h3>Adicione Livros</h3>
                <p>Cadastre seus livros manualmente ou use a busca automática da Google Books</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-search"></i>
                <h3>Busque e Filtre</h3>
                <p>Encontre rapidamente qualquer livro por título, autor ou gênero</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-chart-bar"></i>
                <h3>Estatísticas</h3>
                <p>Acompanhe o crescimento da sua biblioteca com estatísticas detalhadas</p>
            </div>
        </div>
        
        <div class="welcome-actions">
            <a href="{{ url_for("main.register_page") }}" class="btn btn-primary btn-large">
                <i class="fas fa-user-plus"></i>
                Criar Conta Gratuita
            </a>
            <a href="{{ url_for("main.login_page") }}" class="btn btn-secondary btn-large">
                <i class="fas fa-sign-in-alt"></i>
                Já tenho uma conta
            </a>
        </div>
    </div>
</div>

<!-- Conteúdo principal para usuários autenticados -->
<div id="mainContent" class="container" style="display: none;">
    <div class="page-header">
        <h1>
            <i class="fas fa-book-open"></i>
            Minha Coleção de Livros
        </h1>
        <p class="page-subtitle">Organize e gerencie sua biblioteca pessoal</p>
    </div>

    <div class="search-section">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar por título, autor ou gênero..." class="search-input">
            <i class="fas fa-search search-icon"></i>
        </div>
        <div class="filter-container">
            <select id="genreFilter" class="filter-select">
                <option value="">Todos os gêneros</option>
            </select>
        </div>
        
        <!-- NOVO: Filtros de Status de Leitura e Avaliacao -->
        <div class="filter-container">
            <select id="statusFilter" class="filter-select">
                <option value="">Todos os Status</option>
                <option value="want_to_read">Quero Ler</option>
                <option value="reading">Lendo</option>
                <option value="read">Lido</option>
            </select>
        </div>
        
        <div class="filter-container">
            <select id="ratingFilter" class="filter-select">
                <option value="">Todas as Avaliacoes</option>
                <option value="1">1+ Estrela</option>
                <option value="2">2+ Estrelas</option>
                <option value="3">3+ Estrelas</option>
                <option value="4">4+ Estrelas</option>
                <option value="5">5 Estrelas</option>
            </select>
        </div>
        
        <!-- NOVO: Controles de Ordenação -->
        <div class="sort-container">
            <label for="sortBy" class="sort-label">Ordenar por:</label>
            <select id="sortBy" class="filter-select">
                <option value="created_at">Mais Recente</option>
                <option value="title">Título</option>
                <option value="author">Autor</option>
                <option value="year">Ano de Publicação</option>
            </select>
            <button id="sortOrder" class="btn btn-icon btn-secondary" data-order="desc">
                <i class="fas fa-sort-amount-down"></i>
            </button>
        </div>
        
    </div>

    <div class="stats-section">
        <div class="stat-card">
            <i class="fas fa-book"></i>
            <div class="stat-info">
                <span class="stat-number" id="totalBooks">0</span>
                <span class="stat-label">Total de Livros</span>
            </div>
        </div>
        <div class="stat-card">
            <i class="fas fa-tags"></i>
            <div class="stat-info">
                <span class="stat-number" id="totalGenres">0</span>
                <span class="stat-label">Gêneros Únicos</span>
            </div>
        </div>
        <div class="stat-card">
            <i class="fas fa-users"></i>
            <div class="stat-info">
                <span class="stat-number" id="totalAuthors">0</span>
                <span class="stat-label">Autores Únicos</span>
            </div>
        </div>
    </div>

    <div class="books-section">
        <div class="section-header">
            <h2>
                <i class="fas fa-list"></i>
                Seus Livros
            </h2>
            <div class="header-actions">
                <a href="{{ url_for("main.add_book_page") }}" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    Adicionar Livro
                </a>
                
            </div>
        </div>

        <div id="booksContainer" class="books-grid">
            <!-- Os livros serão carregados aqui via JavaScript -->
        </div>

        <!-- NOVO: Controles de Paginação -->
        <div id="paginationControls" class="pagination-controls" style="display: none;">
            <button id="prevPage" class="btn btn-secondary" disabled>
                <i class="fas fa-chevron-left"></i> Anterior
            </button>
            <span id="pageInfo">Página 1 de 1</span>
            <button id="nextPage" class="btn btn-secondary" disabled>
                Próxima <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <div id="emptyState" class="empty-state" style="display: none;">
            <i class="fas fa-book-open"></i>
            <h3>Sua biblioteca está vazia</h3>
            <p>Comece adicionando seu primeiro livro à coleção!</p>
            <a href="{{ url_for("main.add_book_page") }}" class="btn btn-primary">
                <i class="fas fa-plus"></i>
                Adicionar Primeiro Livro
            </a>
        </div>

        <div id="noResults" class="empty-state" style="display: none;">
            <i class="fas fa-search"></i>
            <h3>Nenhum livro encontrado</h3>
            <p>Tente ajustar os filtros de busca.</p>
        </div>
    </div>
</div>

<!-- Modal de Confirmação de Exclusão -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeDeleteModal()">&times;</span>
        <h2>Confirmar Exclusão</h2>
        <p>Tem certeza que deseja excluir este livro? Esta ação não pode ser desfeita.</p>
        <div class="modal-actions">
            <button onclick="closeDeleteModal()" class="btn btn-secondary">Cancelar</button>
            <button onclick="confirmDelete()" class="btn btn-danger">Excluir</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for("static", filename="js/books.js") }}"></script>
{% endblock %}
